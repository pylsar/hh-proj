import{g as j,q,o as A,c as T,a as M,d as x,u as O,b as R}from"./index.esm-CGYwfsyq.js";import{d as z,l as G,m as H,r as t,n as J,c as K,a as h,b as s,p as Q,e as c,i as D,w as f,t as W,F as X,o as C}from"./index-D4FXROvK.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={key:1,class:"pagelist_wrap"},ee=["href"],le=z({__name:"PageList",setup(ae){const g=G(),b=j(),w=H(),i=t([]),y=t(!1),m=t(!1),S=t(!1),n=t(""),u=t(""),d=t(""),r=t(""),p=t(""),B=async()=>{const e=q(T(b,`users/${g.userId}/skills`),A("createdAt","desc"));return(await M(e)).docs.map(o=>o.data())},E=e=>{console.log("edit",e),m.value=!0,n.value=e.skillName,u.value=e.skillSection,d.value=e.skillDescription,r.value=e.skillPrioritys,p.value=e.id},I=async()=>{S.value=!0;try{const e={id:p.value,skillName:n.value,skillSection:u.value,skillDescription:d.value,skillPrioritys:r.value};console.log("editSkillToSend",e);const l=x(b,`users/${g.userId}/skills`,p.value);await O(l,{skillName:n.value,skillSection:u.value,skillDescription:d.value,skillPrioritys:r.value});const o=i.value.findIndex(v=>v.id===p.value);if(o!==-1){const v={...i.value[o],...e};i.value[o]=v}m.value=!1,N()}catch(e){console.error("Ошибка при обновлении навыка:",e)}finally{S.value=!1}},N=()=>{n.value="",u.value="",d.value="",r.value="",p.value=""},U=async e=>{console.log("delete",e),w.require({message:"Вы действительно хотите удалить запись?",header:"Удаление записи",icon:"pi pi-info-circle",rejectLabel:"Отмена",acceptLabel:"Удалить",rejectClass:"p-button-secondary p-button-outlined",acceptClass:"p-button-danger",accept:async()=>{y.value=!0,await R(x(b,`users/${g.userId}/skills`,e));const l=i.value.findIndex(o=>o.id===e);l!==-1&&i.value.splice(l,1),y.value=!1}})};J(async()=>{const e=await B();console.log("listSkills",e),i.value=[...e]});const L=K(()=>!(n.value&&u.value&&d.value));return(e,l)=>{const o=c("app-confirmdialog"),v=c("app-progressspiner"),k=c("app-column"),V=c("app-button"),P=c("app-datatable"),_=c("app-inputtext"),$=c("app-dialog");return C(),h(X,null,[s(o),y.value?(C(),Q(v,{key:0})):(C(),h("div",Z,[l[5]||(l[5]=D("h1",null,"Список Скилов",-1)),s(P,{value:i.value},{default:f(()=>[s(k,{field:"skillName",header:"Название скила"}),s(k,{field:"skillSection",header:"Секция"},{body:f(a=>[D("a",{href:a.data.skillSection},W(a.data.skillSection),9,ee)]),_:1}),s(k,{field:"skillDescription",header:"Описание"}),s(k,{field:"skillPrioritys",header:"Приоритет"}),s(k,null,{body:f(a=>[D("div",null,[s(V,{onClick:F=>E(a.data),icon:"pi pi-pencil",severity:"info"},null,8,["onClick"]),s(V,{onClick:F=>U(a.data.id),icon:"pi pi-trash",severity:"danger"},null,8,["onClick"])])]),_:1})]),_:1},8,["value"])])),s($,{visible:m.value,"onUpdate:visible":l[4]||(l[4]=a=>m.value=a),modal:"",header:"Изменить запись",class:"edit-popup"},{default:f(()=>[s(_,{placeholder:"название",modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=a=>n.value=a),class:"skills__input"},null,8,["modelValue"]),s(_,{placeholder:"раздел",modelValue:u.value,"onUpdate:modelValue":l[1]||(l[1]=a=>u.value=a),class:"skills__input"},null,8,["modelValue"]),s(_,{placeholder:"описание",modelValue:d.value,"onUpdate:modelValue":l[2]||(l[2]=a=>d.value=a),class:"skills__input"},null,8,["modelValue"]),s(_,{placeholder:"приоритет",modelValue:r.value,"onUpdate:modelValue":l[3]||(l[3]=a=>r.value=a),class:"skills__input"},null,8,["modelValue"]),s(V,{onClick:I,label:"Создать",disabled:L.value,loading:S.value},null,8,["disabled","loading"])]),_:1},8,["visible"])],64)}}}),ie=Y(le,[["__scopeId","data-v-ae7ef927"]]);export{ie as default};
